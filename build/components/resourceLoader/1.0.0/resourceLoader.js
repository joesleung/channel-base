define("undefined/mtd/pc/components/resourceLoader/1.0.0/resourceLoader.js",[],function(){var t={ProcessStatus:{NOSTART:0,RUNNING:1,PAUSE:2,COMPLETE:3,ERROR:4},ProcessCommand:{PAUSE:0,STOP:1,NONE:2},FileStatus:{NOSTART:0,RUNNING:1,ERROR:2,COMPLETE:3}},e=function(e){this.conf=$.extend({},e),this.handler={onComplete:null,onError:null},this._file={},this._status=t.FileStatus.NOSTART};e.prototype={constructor:e,_onload:function(){this._status=t.FileStatus.COMPLETE,this.runHandler(this.handler.onComplete,this._file)},_onerror:function(){this._status=t.FileStatus.ERROR,this.runHandler(this.handler.onError,this._file)},status:function(){var t=arguments[0];return void 0===t?this._status:void(this._status=t)},process:function(e){if(this._file=e,this._file.url){var n,s=null;return this._status=t.FileStatus.RUNNING,s=new Image,s.onerror=$.proxy(function(){s=null,this._onerror()},this),s.onload=$.proxy(function(){n||(n=!0,this._onload(),s=null)},this),s.src=this._file.url,s.complete&&!n&&(n=!0,this._onload(),s=null),this}},bind:function(t,e){return this.handler[t]=e,this},runHandler:function(t,e){return t&&t(e),this}};var n=function(t){this.conf=$.extend({},t),this._cache=[],this._complete=[],this.handler={onItemComplete:null,onItemStart:null,onItemError:null,onComplete:null,onStart:null,onError:null,onPause:null}};n.prototype={constructor:n,_createLoader:function(){var t=new e;return t.bind("onComplete",$.proxy(this._onItemComplete,this)).bind("onError",$.proxy(this._onItemError,this))},_getLoader:function(){for(var e=null,n=this._cache.length,s=0;s<n;s++){var o=this._cache[s];if(o.status()!==t.FileStatus.RUNNING){e=o;break}}return null===e&&(e=this._createLoader(),this._cache.push(e)),e},_onItemComplete:function(t){this.runHandler(this.handler.onItemComplete,t.url),this._complete.push(t),this._toComplete(),this._toContinue(),this._toPause()},_onItemError:function(t){this.runHandler(this.handler.onItemError,t.url).runHandler(this.handler.onError,t),this._toComplete(),this._toContinue(),this._toPause()},_toComplete:function(){return 0===this._queue.length&&this._status!==t.ProcessStatus.COMPLETE&&(this._status=t.ProcessStatus.COMPLETE,this.runHandler(this.handler.onComplete),!0)},_toContinue:function(){this._status!==t.ProcessStatus.COMPLETE&&this._command==t.ProcessCommand.NONE&&this._process({queue:this._queue})},_toPause:function(){this._command===t.ProcessCommand.PAUSE&&this._status===t.ProcessStatus.RUNNING&&(this._status=t.ProcessStatus.PAUSE,this.runHandler(this.handler.onPause))},_process:function(){if(this._queue&&(this._command=t.ProcessCommand.NONE,this._status=t.ProcessStatus.RUNNING,!this._toComplete()&&this._queue.length>0)){var e=this._getLoader();if(null!==e){var n=this._queue.pop();n&&(this.runHandler(this.handler.onItemStart,n.uri),e.process({url:n.uri,type:n.type}))}}},process:function(t){return this._queue=t.queue,this.runHandler(this.handler.onStart),this._process(),this},pause:function(){return this._command=t.ProcessCommand.PAUSE,this},goOn:function(){return this._process({queue:this._queue}),this},clear:function(){return this._queue=[],this},bind:function(t,e){return this.handler[t]=e,this},runHandler:function(t,e){return t&&t(e),this}};var s={loaderPool:null,init:function(){this.loaderPool=new n},load:function(t){if(null!==t&&t.length){var e={};this.loaderPool.bind("onItemStart",function(t){var n=new Date,s=n.getTime();e[t]={},e[t].startTime=s}).bind("onItemComplete",function(t){var n=new Date,s=n.getTime();e[t]&&(e[t].endTime=s)}).process({queue:t})}},pause:function(){this.loaderPool.pause()},goOn:function(){this.loaderPool.goOn()},clear:function(){this.loaderPool.clear()}};return s.init(),s});